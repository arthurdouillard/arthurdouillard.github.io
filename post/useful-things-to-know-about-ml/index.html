<!DOCTYPE html>
<html lang="en-us">
<head>

  <meta charset="utf-8">
  <meta name="viewport" content="width=device-width, initial-scale=1">
  <meta http-equiv="X-UA-Compatible" content="IE=edge">
  <meta name="generator" content="Source Themes Academic 3.0.0">
  <meta name="generator" content="Hugo 0.79.0" />
  <meta name="author" content="Arthur Douillard">

  
  
  
  
    
  
  <meta name="description" content="This post contains the notes taken from reading of the following paper:
 A few useful things to know about Machine Learning by Pedro Domingos.  This paper does not introduce any novelties in the field of Machine Learning, nor some kinds of benchmarks, but rather offers a overview of the black art of Machine Learning. Domingos covers a wide area of Machine Learning, but each parts are not explored in depth.">

  
  <link rel="alternate" hreflang="en-us" href="/post/useful-things-to-know-about-ml/">

  


  

  

  

  
  
  
  <meta name="theme-color" content="#e0491f">
  

  
  
  
  
    
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/4.1.3/css/bootstrap.min.css" integrity="sha256-eSi1q2PG6J7g7ib17yAaWMcrr5GrtohYChqibrV7PBE=" crossorigin="anonymous">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/academicons/1.8.6/css/academicons.min.css" integrity="sha256-uFVgMKfistnJAfoCUQigIl+JfUaP47GrRKjf6CTPVmw=" crossorigin="anonymous">
    <link rel="stylesheet" href="https://use.fontawesome.com/releases/v5.4.1/css/all.css" integrity="sha384-5sAR7xN1Nv6T6+dT2mhtzEpVJvfS3NScPQTrOxhwjIuvcA67KV2R5Jz6kr4abQsz" crossorigin="anonymous">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/fancybox/3.2.5/jquery.fancybox.min.css" integrity="sha256-ygkqlh3CYSUri3LhQxzdcm0n1EQvH2Y+U5S2idbLtxs=" crossorigin="anonymous">

    
    
    
      
    
    

    

    

  

  
  
  <link rel="stylesheet" href="//fonts.googleapis.com/css?family=Montserrat:400,700|Roboto:400,400italic,700|Roboto+Mono">
  

  <link rel="stylesheet" href="/styles.css">
  
  <link rel="stylesheet" href="/css/search_bar.css">
  

  
  
    <script>
      window.ga=window.ga||function(){(ga.q=ga.q||[]).push(arguments)};ga.l=+new Date;
      ga('create', 'UA-102629480-1', 'auto');
      
      ga('require', 'eventTracker');
      ga('require', 'outboundLinkTracker');
      ga('require', 'urlChangeTracker');
      ga('send', 'pageview');
    </script>
    <script async src="//www.google-analytics.com/analytics.js"></script>
    
    <script async src="https://cdnjs.cloudflare.com/ajax/libs/autotrack/2.4.1/autotrack.js" integrity="sha512-HUmooslVKj4m6OBu0OgzjXXr+QuFYy/k7eLI5jdeEy/F4RSgMn6XRWRGkFi5IFaFgy7uFTkegp3Z0XnJf3Jq+g==" crossorigin="anonymous"></script>
    
  
  

  
  <link rel="alternate" href="/index.xml" type="application/rss+xml" title="Arthur Douillard">
  <link rel="feed" href="/index.xml" type="application/rss+xml" title="Arthur Douillard">
  

  <link rel="manifest" href="/site.webmanifest">
  <link rel="icon" type="image/png" href="/img/icon.png">
  <link rel="apple-touch-icon" type="image/png" href="/img/icon-192.png">

  <link rel="canonical" href="/post/useful-things-to-know-about-ml/">

  <meta property="twitter:card" content="summary_large_image">
  
  <meta property="twitter:site" content="@Ar_Douilllard">
  <meta property="twitter:creator" content="@Ar_Douilllard">
  
  <meta property="og:site_name" content="Arthur Douillard">
  <meta property="og:url" content="/post/useful-things-to-know-about-ml/">
  <meta property="og:title" content="A Few Useful Things To Know About Machine Learning | Arthur Douillard">
  <meta property="og:description" content="This post contains the notes taken from reading of the following paper:
 A few useful things to know about Machine Learning by Pedro Domingos.  This paper does not introduce any novelties in the field of Machine Learning, nor some kinds of benchmarks, but rather offers a overview of the black art of Machine Learning. Domingos covers a wide area of Machine Learning, but each parts are not explored in depth.">
  
  
    
  <meta property="og:image" content="/img/icon-192.png">
  <meta property="og:locale" content="en-us">
  
  <meta property="article:published_time" content="2018-02-06T00:00:00&#43;01:00">
  
  <meta property="article:modified_time" content="2018-02-06T00:00:00&#43;01:00">
  

  

  
<meta name="twitter:title" content="A Few Useful Things To Know About Machine Learning" />





<meta name="twitter:image" content="/blog/bias-variance.png" />



<meta property="og:image" content=/blog/bias-variance.png />




<link rel="icon" type="image/png" href="/img/favicon32.png">
<link rel="apple-touch-icon" type="image/png" href="/img/favicon180.png">


  <title>A Few Useful Things To Know About Machine Learning | Arthur Douillard</title>

</head>
<body id="top" data-spy="scroll" data-target="#TableOfContents" data-offset="71" >

<nav class="navbar navbar-light fixed-top navbar-expand-lg py-0" id="navbar-main">
  <div class="container">

    
      <a class="navbar-brand" href="/">Arthur Douillard</a>
      
      <button type="button" class="navbar-toggler" data-toggle="collapse"
              data-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
        <span><i class="fas fa-bars"></i></span>
      </button>
      

    
    <div class="collapse navbar-collapse" id="navbar">

      
      
      <ul class="navbar-nav ml-auto">
        

        

        
        
        
          
        

        <li class="nav-item">
          <a class="nav-link" href="/#about">
            
            <span>Home</span>
            
          </a>
        </li>

        
        

        

        
        
        
          
        

        <li class="nav-item">
          <a class="nav-link" href="/#publications">
            
            <span>Publications</span>
            
          </a>
        </li>

        
        

        

        
        
        
          
        

        <li class="nav-item">
          <a class="nav-link" href="/#posts">
            
            <span>Posts</span>
            
          </a>
        </li>

        
        

        

        
        
        
          
        

        <li class="nav-item">
          <a class="nav-link" href="/#projects">
            
            <span>Projects</span>
            
          </a>
        </li>

        
        

        

        
        
        
          
        

        <li class="nav-item">
          <a class="nav-link" href="/#talks_list">
            
            <span>Talks</span>
            
          </a>
        </li>

        
        

        

        
        
        
          
        

        <li class="nav-item">
          <a class="nav-link" href="/#teaching">
            
            <span>Teaching</span>
            
          </a>
        </li>

        
        

        

        
        
        
          
        

        <li class="nav-item">
          <a class="nav-link" href="/books">
            
            <span>Books</span>
            
          </a>
        </li>

        
        

      

        

        
      </ul>

    </div>
  </div>
</nav>


<article class="article" itemscope itemtype="http://schema.org/Article">

  

















<div class="article-container pt-3">
  <h1 itemprop="name">A Few Useful Things To Know About Machine Learning</h1>

  

  
  

<div class="article-metadata">

  
  
  <span itemscope itemprop="author" itemtype="http://schema.org/Person">
    <meta itemprop="name" content="Arthur Douillard">
  </span>
  

  <span class="article-date">
    
    <meta content="2018-02-06 00:00:00 &#43;0100 CET" itemprop="datePublished">
    <time datetime="2018-02-06 00:00:00 &#43;0100 CET" itemprop="dateModified">
      6 February, 2018
    </time>
  </span>
  <span itemscope itemprop="publisher" itemtype="http://schema.org/Person">
    <meta itemprop="name" content="Arthur Douillard">
  </span>

  
  <span class="middot-divider"></span>
  <span class="article-reading-time">
    6 min read
  </span>
  
  

  
  

  

  
  

  

</div>

  
</div>



  <div class="article-container">

    <div class="article-style" itemprop="articleBody">
      <p>This post contains the notes taken from reading of the following paper:</p>
<ul>
<li><a href="https://homes.cs.washington.edu/~pedrod/papers/cacm12.pdf">A few useful things to know about Machine Learning</a>
by <a href="https://scholar.google.com/citations?user=KOrhfVMAAAAJ&amp;hl=en">Pedro Domingos</a>.</li>
</ul>
<p>This paper does not introduce any novelties in the field of Machine Learning, nor
some kinds of benchmarks, but rather offers a overview of the <em>black art</em> of
Machine Learning. Domingos covers a wide area of Machine Learning, but each
parts are not explored in depth.</p>
<h1 id="the-right-algorithm">The Right Algorithm</h1>
<p>Domingos splits the problem of choosing the right algorithm in three sub-problems:</p>
<ul>
<li>Finding the good <strong>representation</strong> (<em>hyperplanes, rules, decision trees, etc.</em>)</li>
<li>The <strong>objective function</strong> to optimize (<em>accuracy, likelihood, cross-entropy, etc.</em>)</li>
<li>The <strong>optimization method</strong> (<em>quadratric, beam search, gradient descent, etc.</em>)</li>
</ul>
<p>The optimal combinations should be taken according to hyperparameters: The accuracy,
the training time, the problem type, etc.</p>
<h1 id="evaluating-the-algorithm">Evaluating The Algorithm</h1>
<p>Domingos notes that while a high accuracy may seem <em>good</em>, it is not a sufficient
indicator. A high score of accuracy on the <em>train data</em> may simply mean that the
algorithm has an <em>overfit</em> problem, and thus generalize badly on new unseen data.</p>
<p>A common pitfall would be to train the algorithm on the train data and tweak
the hyperparameters in order to maximize our score on the <em>test data</em>. This may
lead to an overfit on also the test data!</p>
<p>The generalization problems (<em>how can I estimate my generalization?</em> and <em>how
can I improve my generalization</em>) are detailed in the further sections.</p>
<h1 id="the-bias-variance-trade-off">The Bias-Variance Trade-off</h1>
<p>When building a model it is interesting to decompose the generalization error
into two components: the <em>bias</em> and the <em>variance</em>.</p>
<blockquote>
<p><strong>Bias</strong> is a learner&rsquo;s tendency to consistently learn the same wrong thing.</p>
<p><strong>Variance</strong> is the tendency to learn random things irrespective of the real signal.</p>
</blockquote>
<p><img src="/blog/bias-variance.png" alt="Bias-Variance trade-off in dart-throwing"></p>
<p>This trade-off explains why a powerful learner may not be better than a weak learner.
If my powerful learner has a low bias, he is performing well on the
train data. However if my powerful learner has also a high variance, it may
have learned noise from the train data that would be irrelevant for the test
data and behave randomly.</p>
<h1 id="reducing-the-variance">Reducing The Variance</h1>
<p>There are several ways to reduce the variance:</p>
<h3 id="train-validation-and-test">Train, Validation, and Test</h3>
<p>Before training your model, the data should be split in three parts:</p>
<ul>
<li><strong>Train</strong>: On which the model will learn.</li>
<li><strong>Validation</strong>: On which we will optimize model&rsquo;s performance by tweaking the parameters.</li>
<li><strong>Test</strong>: To test the model, only at the end.</li>
</ul>
<p><img src="/blog/train-validation-test.png" alt="Train-Validation-Test split"></p>
<p>In a certain way, we are overfitting on <em>validation</em> by tweaking the parameters
according to the <em>validation</em>&rsquo;s performance. In order to mitigate this we can
use the cross-validation:</p>
<h3 id="cross-validation">Cross-Validation</h3>
<p>We are still training the model on <em>train</em>, and tweaking the parameters in order
to optimize <em>validation</em>.</p>
<p>However instead of evaluating a fixed validation set, we are evaluating the average
performance of the different folds:</p>
<p><img src="/blog/cross-validation.png" alt="k-fold cross-validations"></p>
<p>Note that if there is too many parameters choices, the cross-validation may
not be able to avoid overfitting.</p>
<h3 id="regularization">Regularization</h3>
<p>Another way to way to avoid overfitting is to add <em>regularization</em>. It will force
the model to be simpler.</p>
<p>Let&rsquo;s say the model has a set of weights $W$, an evaluation function $f(X)$
(that depends of the weights), and a loss function $L(X, Y)$.</p>
<p>Without regularization the model will try to optimize:</p>
<p>$$L(X, f(X))$$</p>
<p>With a regularization $R(W)$:</p>
<p>$$L(X, f(X)) + \lambda R(W)$$</p>
<p>The regularization is multiplied by a factor $\lambda$ that is determined empirically,
with cross-validation for example.</p>
<p>There are several regularizations possible. The two most common are <strong>L1</strong>
(also known as <em>LASSO</em>), and <strong>L2</strong> (also known as <em>Ridge</em>):</p>
<p>L1 is the absolute norm:</p>
<p>$$\Vert W \Vert_1 = \Sigma_{i=1}^n |w_i|$$</p>
<p>While L2 is:</p>
<p>$$\Vert W \Vert_2 = \Sigma_{i=1}^{n} w_i^2$$</p>
<h1 id="the-curse-of-dimensionality">The Curse Of Dimensionality</h1>
<p>In addition of overfitting, a model can also fail to learn high-dimensional
data.</p>
<p>For example, let&rsquo;s imagine that we want to use a decision tree to learn
data which features are binary discrete values. If there are 10 features, it would
mean that there is a thousand possible samples. If there are 100 features (which
is common), there are a thousand billion of billion of billion possible samples.
It is unlearnable, either because the model will never generalize correctly, or
the model will take a non-practical amount of time to learn.</p>
<p>Thankfully, the data&rsquo;s features are often not completely independent and many
features are just noise. The <em>blessing of non-uniformity</em> as Domingos calls,
implies the samples are often spread on a lower-dimensional manifold.</p>
<p>To reduce the dimension, i.e. choosing the right features, <a href="https://en.wikipedia.org/wiki/Dimensionality_reduction">many algorithms</a> exist:
PCA, NMF, LDA, etc.</p>
<p>The  reduction of dimensionality is an often necessary step before feeding the
model with the data.</p>
<h1 id="feature-engineering-is-the-key">Feature Engineering Is The Key</h1>
<p>Feature Engineering is the action of transforming raw data into something that
is more learnable by the model. It is dependant on the data&rsquo;s type, and here
lies most of the <em>black art</em> of Machine Learning.</p>
<p>Two examples:</p>
<p>For text data, several processing are necessary:</p>
<ul>
<li><strong>tokenization</strong> to split the words of the sentence.</li>
<li><strong>lemmatization</strong> to get the lemma (<em>loved, loving, lover -&gt; love</em>)</li>
<li><strong>POS-Tagging</strong> to get the grammar label of a token (<em>be -&gt; verb, car -&gt; noun</em>)</li>
</ul>
<p>For image data, in the case of object detection we can extract interesting
features with the <a href="https://www.learnopencv.com/histogram-of-oriented-gradients/">HOG algorithm</a>
and feed these features to a SVM to <a href="https://github.com/Mougatine/human-recognition/blob/master/tirf_project.ipynb">improve significantly the performances</a>.</p>
<p>While feature engineering is major part of Machine Learning, it is less important
in Deep Learning: with Convolutional Neural Network (CNN) the model is learning
by itself the <a href="https://cs.stanford.edu/people/karpathy/convnetjs/demo/cifar10.html">convolution kernels</a> extracting the interesting features.</p>
<h1 id="model-ensembles">Model Ensembles</h1>
<p>In order to achieve the best performance we want to decrease both bias and variance.
It is often complicated to optimize this trade-off. A great way to achieve this
is to combine different models, kind of like a <em>wisdom of the crowd</em>.</p>
<p>There are three main categories of ensembles:</p>
<h3 id="bagging">Bagging</h3>
<p>Used in the <strong>Random Forest</strong>, bagging generates plenty of model. Each has a low
bias but a high variance. A voting system is set up between them to choose the
output, thus lowering the individual variances.</p>
<h3 id="boosting">Boosting</h3>
<p>Used in <strong>Adaboost</strong> or in <strong>Gradient Boosting</strong>, boosting generates at first
a simple weak learner: It should just be a bit better than a random guess. At each
iteration of the training, a new weak learner is added to the global learner. The
new weak learner focuses on the previously poorly predicted data.</p>
<p>At each iteration the bias is reduced as the overall model improves. There is a
diminished risk of overfitting with boosting: Because each iteration&rsquo;s learner
focuses on poorly predicted data, the risk of <em>over-learning</em> data is small.</p>
<h3 id="stacking">Stacking</h3>
<p>The stacking ensemble is the easiest to understand: Each model is connected to
another: The output of one is the input of another.</p>
<h1 id="data-data-and-data">Data, Data, And Data</h1>
<p>While Domingos offers us great insights into Machine Learning, and various
methods to improve our models, he notes one constant:</p>
<blockquote>
<p>More data beats a cleverer algorithm</p>
</blockquote>
<p>It is often more advisable to focus the efforts on getting as much data as
possible, and begin with a simple model, than to expect a complex model to
generalize from few data.</p>
<h3 id="available-data">Available Data</h3>
<p>There are plenty of resources available:</p>
<ul>
<li><a href="https://archive.ics.uci.edu/ml/datasets.html">UCL Datasets</a></li>
<li><a href="https://www.kaggle.com/datasets">Kaggle Datasets</a></li>
<li><a href="https://www.cs.toronto.edu/~kriz/cifar.html">CIFAR</a>,
<a href="http://www.image-net.org/">ImageNet</a>, <a href="http://cocodataset.org/#home">COCO</a></li>
<li>&hellip;</li>
</ul>

    </div>

    




    

    
    

    
    <div class="article-widget">
      <div class="post-nav">
  
  <div class="post-nav-item">
    <div class="meta-nav">Next</div>
    <a href="/post/efficient-graph-based-segmentation/" rel="next">Efficient Graph-Based Segmentation</a>
  </div>
  
  
  <div class="post-nav-item">
    <div class="meta-nav">Previous</div>
    <a href="/post/how-to-read-a-paper/" rel="prev">How To Read A Paper</a>
  </div>
  
</div>

    </div>
    

    
<button id="disqus-show"
  style="background-color: rgb(20, 22, 34); color: rgb(248, 248, 242); border-style: none">
  <i class="fa fa-angle-double-right"></i>&nbsp;Comments
</button>
<section id="comments">
  <div id="disqus_thread"></div>
<script type="application/javascript">
    var disqus_config = function () {
    
    
    
    };
    (function() {
        if (["localhost", "127.0.0.1"].indexOf(window.location.hostname) != -1) {
            document.getElementById('disqus_thread').innerHTML = 'Disqus comments not available by default when the website is previewed locally.';
            return;
        }
        var d = document, s = d.createElement('script'); s.async = true;
        s.src = '//' + "arthurdouillard" + '.disqus.com/embed.js';
        s.setAttribute('data-timestamp', +new Date());
        (d.head || d.body).appendChild(s);
    })();
</script>
<noscript>Please enable JavaScript to view the <a href="https://disqus.com/?ref_noscript">comments powered by Disqus.</a></noscript>
<a href="https://disqus.com" class="dsq-brlink">comments powered by <span class="logo-disqus">Disqus</span></a>
</section>


<script type="text/javascript">
  var a=document.querySelector("#disqus-show")
  var b=document.querySelector("#comments")

  b.style.display = "none";

  a.addEventListener("click",
    function(){
      ""==b.style.display?(b.style.display="none", a.innerHTML="<i class=\"fa fa fa-angle-double-right\"/i>&nbsp;Comments"):(b.style.display="",a.innerHTML="<i class=\"fa fa-angle-double-down\"></i>&nbsp;Comments");
      a.style = "background-color: rgb(20, 22, 34); color: rgb(248, 248, 242); border-style: none";
      }
  );
</script>

<style>

</style>


  </div>
</article>

<div class="container">
  <footer class="site-footer">
  

  <p class="powered-by">
    Â© 2018 &middot; 

    Powered by the
    <a href="https://sourcethemes.com/academic/" target="_blank" rel="noopener">Academic theme</a> for
    <a href="https://gohugo.io" target="_blank" rel="noopener">Hugo</a>.

    
    <span class="float-right" aria-hidden="true">
      <a href="#" id="back_to_top">
        <span class="button_icon">
          <i class="fas fa-chevron-up fa-2x"></i>
        </span>
      </a>
    </span>
    
  </p>
</footer>

</div>


<div id="modal" class="modal fade" role="dialog">
  <div class="modal-dialog">
    <div class="modal-content">
      <div class="modal-header">
        <h5 class="modal-title">Cite</h5>
        <button type="button" class="close" data-dismiss="modal" aria-label="Close">
          <span aria-hidden="true">&times;</span>
        </button>
      </div>
      <div class="modal-body">
        <pre><code class="tex hljs"></code></pre>
      </div>
      <div class="modal-footer">
        <a class="btn btn-outline-primary my-1 js-copy-cite" href="#" target="_blank">
          <i class="fas fa-copy"></i> Copy
        </a>
        <a class="btn btn-outline-primary my-1 js-download-cite" href="#" target="_blank">
          <i class="fas fa-download"></i> Download
        </a>
        <div id="modal-error"></div>
      </div>
    </div>
  </div>
</div>





<script type="text/x-mathjax-config">
      MathJax.Hub.Config({
        CommonHTML: { linebreaks: { automatic: true } },
        tex2jax: { inlineMath: [ ['$', '$'], ['\\(','\\)'] ], displayMath: [ ['$$','$$'], ['\\[', '\\]'] ], processEscapes: false },
        TeX: { noUndefined: { attributes: { mathcolor: 'red', mathbackground: '#FFEEEE', mathsize: '90%' } } },
        messageStyle: 'none'
      });
    </script>





<script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js" integrity="sha512-+NqPlbbtM1QqiK8ZAo4Yrj2c4lNQoGv8P79DPtKzj++l5jnN39rHA/xsqn8zE9l0uSoxaCdrOgFs6yjyfbBxSg==" crossorigin="anonymous"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/jquery.imagesloaded/4.1.3/imagesloaded.pkgd.min.js" integrity="sha512-umsR78NN0D23AzgoZ11K7raBD+R6hqKojyBZs1w8WvYlsI+QuKRGBx3LFCwhatzBunCjDuJpDHwxD13sLMbpRA==" crossorigin="anonymous"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/4.1.3/js/bootstrap.min.js" integrity="sha256-VsEqElsCHSGmnmHXGQzvoWjWwoznFSZc6hs7ARLRacQ=" crossorigin="anonymous"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/jquery.isotope/3.0.4/isotope.pkgd.min.js" integrity="sha512-VDBOIlDbuC4VWxGJNmuFRQ0Li0SKkDpmGyuhAG5LTDLd/dJ/S0WMVxriR2Y+CyPL5gzjpN4f/6iqWVBJlht0tQ==" crossorigin="anonymous"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/fancybox/3.2.5/jquery.fancybox.min.js" integrity="sha256-X5PoE3KU5l+JcX+w09p/wHl9AzK333C4hJ2I9S5mD4M=" crossorigin="anonymous"></script>





<script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.4/MathJax.js?config=TeX-AMS_CHTML-full" integrity="sha256-GhM+5JHb6QUzOQPXSJLEWP7R73CbkisjzK5Eyij4U9w=" crossorigin="anonymous" async></script>




<script src="/js/hugo-academic.js"></script>














<script src="https://cdnjs.cloudflare.com/ajax/libs/instantsearch.js/2.10.2/instantsearch.min.js" integrity="sha256-gFCtPk/sonctyfwYOgjrPoWApQ0rqB6ezBBZ7p32yGc=" crossorigin="anonymous"></script>
<script>
  const content_type = {
    'post': "Posts",
  'project': { { i18n "projects" } },
  'publication' : { { i18n "publications" } },
  'talk' : { { i18n "talks" } }
      };

  function getTemplate(templateName) {
    return document.querySelector(`#${templateName}-template`).innerHTML;
  }

  const options = {
    appId: "",
  apiKey: { { .Site.Params.search.algolia.api_key } },
  indexName: { { .Site.Params.search.algolia.index_name } },
  routing: true,
    searchParameters: {
    hitsPerPage: 10
  },
  searchFunction: function(helper) {
    let searchResults = document.querySelector('#search-hits')
    if (helper.state.query === '') {
      searchResults.style.display = 'none';
      return;
    }
    helper.search();
    searchResults.style.display = 'block';
  }
      };

  const search = instantsearch(options);

  
  search.addWidget(
    instantsearch.widgets.searchBox({
      container: '#search-box',
      placeholder: "Search..."
        })
  );

  
  search.addWidget(
    instantsearch.widgets.infiniteHits({
      container: '#search-hits',
      templates: {
        empty: '<div class="search-no-results">' + "No results found" + '</div>',
      item: getTemplate('search-hit')
          },
      cssClasses: {
      showmoreButton: 'btn btn-primary btn-outline'
    }
        })
  );

  
  search.on('render', function () {
    $('.search-hit-type').each(function (index) {
      let content_key = $(this).text();
      if (content_key in content_type) {
        $(this).text(content_type[content_key]);
      }
    });
  });

  
  search.start();
</script>


</body>

</html>

